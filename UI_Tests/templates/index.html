<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Gas Station Circuit</title>
    <style>
        input[type="number"] {
            width: 60px; /* Smaller width for input boxes */
            margin: 5px;
        }
    </style>
    <script>
        function addInput() {
            const gasDiv = document.getElementById('gas-inputs');
            const costDiv = document.getElementById('cost-inputs');

            const newGasInput = document.createElement('input');
            newGasInput.type = 'number';
            newGasInput.name = 'gas[]';
            gasDiv.appendChild(newGasInput);

            const newCostInput = document.createElement('input');
            newCostInput.type = 'number';
            newCostInput.name = 'cost[]';
            costDiv.appendChild(newCostInput);
        }

        function removeInput() {
            const gasDiv = document.getElementById('gas-inputs');
            const costDiv = document.getElementById('cost-inputs');

            if (gasDiv.children.length > 1) {
                gasDiv.removeChild(gasDiv.lastChild);
                costDiv.removeChild(costDiv.lastChild);
            }
        }

        function loadTestCase() {
            const select = document.getElementById('test-case-select');
            const index = select.value;
            
            fetch('/test_case/' + index)
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        alert(data.error);
                    } else {
                        const gasDiv = document.getElementById('gas-inputs');
                        const costDiv = document.getElementById('cost-inputs');
                        const commentDiv = document.getElementById('test-case-comment');

                        // Clear existing inputs
                        while (gasDiv.firstChild) gasDiv.removeChild(gasDiv.firstChild);
                        while (costDiv.firstChild) costDiv.removeChild(costDiv.firstChild);

                        // Add new inputs
                        const gasLabel = document.createElement('label');
                        gasLabel.textContent = 'Gas:';
                        gasDiv.appendChild(gasLabel);

                        data.gas.forEach(value => {
                            const newGasInput = document.createElement('input');
                            newGasInput.type = 'number';
                            newGasInput.name = 'gas[]';
                            newGasInput.value = value;
                            gasDiv.appendChild(newGasInput);
                        });

                        const costLabel = document.createElement('label');
                        costLabel.textContent = 'Cost:';
                        costDiv.appendChild(costLabel);

                        data.cost.forEach(value => {
                            const newCostInput = document.createElement('input');
                            newCostInput.type = 'number';
                            newCostInput.name = 'cost[]';
                            newCostInput.value = value;
                            costDiv.appendChild(newCostInput);
                        });

                        // Display comment
                        commentDiv.textContent = data.comment;
                    }
                });
        }
    </script>
</head>
<body>
    <h1>Gas Station Circuit</h1>
    <div>
        <label for="test-case-select">Select Test Case:</label>
        <select id="test-case-select" onchange="loadTestCase()">
            <option value="" disabled selected>Select a test case</option>
            {% for index in range(test_cases|length) %}
                <option value="{{ index }}">Test Case {{ index + 1 }}</option>
            {% endfor %}
        </select>
    </div>
    <div id="test-case-comment"></div>
    <form id="gas-cost-form" method="post" action="/solve">
        <div id="gas-inputs">
            <label>Gas:</label>
            <input type="number" name="gas[]" required>
        </div>
        <div id="cost-inputs">
            <label>Cost:</label>
            <input type="number" name="cost[]" required>
        </div>
        <button type="button" onclick="addInput()">Add more</button>
        <button type="button" onclick="removeInput()">Remove</button>
        <button type="submit">Submit</button>
    </form>
    <div id="result"></div>
    <script>
        document.getElementById('gas-cost-form').addEventListener('submit', function(event) {
            event.preventDefault();
            const formData = new FormData(this);

            fetch('/solve', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('result').textContent = 'Result: ' + data.result;
            });
        });
    </script>
</body>
</html>
